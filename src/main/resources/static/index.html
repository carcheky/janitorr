<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Janitorr Management UI</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Dry-run banner -->
    <div id="dryRunBanner" class="dry-run-banner" style="display: none;">
        <span class="banner-icon">‚ÑπÔ∏è</span>
        <span class="banner-text">
            <strong>Dry-Run Mode Active:</strong> No files will be deleted. This is a simulation mode.
        </span>
    </div>

    <div class="container">
        <header>
            <h1>üßπ Janitorr Management</h1>
            <p class="subtitle">Manage and manually launch cleanup functions</p>
            <nav class="nav-links" style="margin-top: 1rem;">
                <a href="rule-builder.html" style="color: #3b82f6; text-decoration: none; font-weight: 500;">üß© Rule Builder ‚Üí</a>
            </nav>
        </header>

        <!-- Dashboard Analytics Section -->
        <section class="dashboard-section">
            <h2>üìä Dashboard Analytics</h2>
            
            <!-- Quick Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üóëÔ∏è</div>
                    <div class="stat-content">
                        <div class="stat-label">Total Files Deleted</div>
                        <div id="totalFilesDeleted" class="stat-value">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üíæ</div>
                    <div class="stat-content">
                        <div class="stat-label">Space Freed</div>
                        <div id="totalSpaceFreed" class="stat-value">0 GB</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üé¨</div>
                    <div class="stat-content">
                        <div class="stat-label">Movies Cleaned</div>
                        <div id="moviesDeleted" class="stat-value">0</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üì∫</div>
                    <div class="stat-content">
                        <div class="stat-label">Shows Cleaned</div>
                        <div id="showsDeleted" class="stat-value">0</div>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="charts-row">
                <div class="chart-container">
                    <h3>Cleanup Activity (Last 30 Events)</h3>
                    <canvas id="cleanupHistoryChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Media Type Distribution</h3>
                    <canvas id="mediaTypeChart"></canvas>
                </div>
            </div>
        </section>

        <section class="status-section">
            <h2>System Status</h2>
            <div id="statusContainer" class="status-grid">
                <div class="status-item">
                    <span class="status-label">Dry Run Mode:</span>
                    <span id="dryRunStatus" class="status-value">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Run Once Mode:</span>
                    <span id="runOnceStatus" class="status-value">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Media Deletion:</span>
                    <span id="mediaEnabledStatus" class="status-value">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Tag-Based Deletion:</span>
                    <span id="tagEnabledStatus" class="status-value">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Episode Deletion:</span>
                    <span id="episodeEnabledStatus" class="status-value">Loading...</span>
                </div>
            </div>
            <button id="refreshStatusBtn" class="btn btn-secondary">Refresh Status</button>
        </section>

        <section class="cleanup-section">
            <h2>Manual Cleanup Actions</h2>
            <div class="cleanup-grid">
                <div class="cleanup-card">
                    <h3>Media Cleanup</h3>
                    <p>Cleanup movies and TV shows based on age and disk space thresholds.</p>
                    <div class="cleanup-status">
                        <span class="status-label">Last Run:</span>
                        <span id="mediaLastRun" class="status-value">Not yet</span>
                    </div>
                    <button id="mediaCleanupBtn" class="btn btn-primary">Run Media Cleanup</button>
                </div>

                <div class="cleanup-card">
                    <h3>Tag-Based Cleanup</h3>
                    <p>Cleanup media based on configured tags and schedules.</p>
                    <div class="cleanup-status">
                        <span class="status-label">Last Run:</span>
                        <span id="tagLastRun" class="status-value">Not yet</span>
                    </div>
                    <button id="tagCleanupBtn" class="btn btn-primary">Run Tag-Based Cleanup</button>
                </div>

                <div class="cleanup-card">
                    <h3>Episode Cleanup</h3>
                    <p>Cleanup episodes of shows with the configured tag based on age and count.</p>
                    <div class="cleanup-status">
                        <span class="status-label">Last Run:</span>
                        <span id="episodeLastRun" class="status-value">Not yet</span>
                    </div>
                    <button id="episodeCleanupBtn" class="btn btn-primary">Run Episode Cleanup</button>
                </div>
            </div>
        </section>

        <section class="notifications-section">
            <h2>Notification Testing</h2>
            <p>Test your configured notification channels to ensure they are working correctly.</p>
            <div class="notifications-grid">
                <div class="notification-card">
                    <h3>üü£ Discord</h3>
                    <p>Test Discord webhook notifications</p>
                    <button id="testDiscordBtn" class="btn btn-secondary">Test Discord</button>
                </div>

                <div class="notification-card">
                    <h3>‚úàÔ∏è Telegram</h3>
                    <p>Test Telegram bot notifications</p>
                    <button id="testTelegramBtn" class="btn btn-secondary">Test Telegram</button>
                </div>

                <div class="notification-card">
                    <h3>üìß Email</h3>
                    <p>Test email (SMTP) notifications</p>
                    <button id="testEmailBtn" class="btn btn-secondary">Test Email</button>
                </div>

                <div class="notification-card">
                    <h3>üîó Webhook</h3>
                    <p>Test generic webhook notifications</p>
                    <button id="testWebhookBtn" class="btn btn-secondary">Test Webhook</button>
                </div>
            </div>
        </section>

        <section class="message-section">
            <div id="messageContainer"></div>
        </section>
    </div>

    <script src="app.js"></script>
</body>
</html>
